---
title: "Replicating Published Research with bayesTPC"
subtitle: "A step-by-step guide to refitting thermal performance curves from El Moustaid et al. (2021)"
format: html
toc: true
---

In this blog post, I'll walk you through my process of replicating thermal performance curve analyses from [El Moustaid et al. (2021)](https://doi.org/10.1186/s13071-021-04826-y) using `bayesTPC`. I'll show you how I take published research and recreate it with modern Bayesian methods.

## The Paper I'm Replicating

**Title**: "Predicting temperature-dependent transmission suitability of bluetongue virus in livestock"  
**Journal**: Parasites & Vectors (2021)  
**DOI**: [10.1186/s13071-021-04826-y](https://doi.org/10.1186/s13071-021-04826-y)

## Data Preparation

[To be developed as I work through the paper step by step]

## Replicating Figure 3: Latent Period Survival Probability

Let's start by replicating Figure 3 from the paper, which shows how the probability of a midge surviving the extrinsic incubation period (EIP) and becoming infectious varies with mortality rate and parasite development rate.

### Understanding the Problem

The survival probability **f** depends on two key traits:
- **μ** (mu): Adult mortality rate
- **ν** (nu): Parasite development rate (ν = 1/EIP)

The paper compares three competing functional forms from the literature:

1. **Dietz (1993)**: `f₁ = e^(-μ/ν)`
2. **Gubbins et al. (2008)**: `f₂ = ν/(ν + μ)`  
3. **Turner et al. (2013)**: `f₃ = (3ν/(3ν + μ))³`

### Implementing the Formulas

Let me create these functions in R:

```{r}
#| label: f-functions
#| echo: true

# Three formulas for survival probability
f_dietz <- function(mu, nu) {
  exp(-mu/nu)
}

f_gubbins <- function(mu, nu) {
  nu / (nu + mu)
}

f_turner <- function(mu, nu) {
  (3*nu / (3*nu + mu))^3
}
```

### Creating Figure 3

Now let's replicate the two panels from Figure 3. The paper uses fixed values:
- **ν = 0.061** (mean parasite development rate) for the left panel
- **μ = 0.15** (mean mortality rate) for the right panel

```{r}
#| label: figure3-replication
#| echo: true
#| fig-cap: "Replication of Figure 3: Latent period survival probability f as a function of mortality rate μ (left) and parasite development rate ν (right)"
#| fig-width: 12
#| fig-height: 5

# Setup for side-by-side plots
par(mfrow = c(1, 2), mar = c(5, 5, 4, 2))

# Left: mortality vs survival (ν fixed at 0.061)
mu_range <- seq(0.2, 0.5, length.out = 100)
nu_fixed <- 0.061

f1_left <- f_dietz(mu_range, nu_fixed)
f2_left <- f_gubbins(mu_range, nu_fixed)
f3_left <- f_turner(mu_range, nu_fixed)

plot(mu_range, f1_left, type = "l", col = "black", lwd = 2,
     xlab = "Mortality rate μ", ylab = "Survival probability f",
     main = "f vs μ (ν = 0.061)", ylim = c(0, 1), cex.lab = 1.2, cex.main = 1.3)
lines(mu_range, f2_left, col = "blue", lwd = 2)
lines(mu_range, f3_left, col = "purple", lwd = 2)
legend("topright", legend = c("Dietz (1993)", "Gubbins et al. (2008)", "Turner et al. (2013)"),
       col = c("black", "blue", "purple"), lwd = 2, bty = "n", cex = 1.1)

# Right: parasite development vs survival (μ fixed at 0.15)
nu_range <- seq(0, 0.7, length.out = 100)
mu_fixed <- 0.15

f1_right <- f_dietz(mu_fixed, nu_range)
f2_right <- f_gubbins(mu_fixed, nu_range)
f3_right <- f_turner(mu_fixed, nu_range)

plot(nu_range, f1_right, type = "l", col = "black", lwd = 2,
     xlab = "Parasite development rate ν", ylab = "Survival probability f",
     main = "f vs ν (μ = 0.15)", ylim = c(0, 1), cex.lab = 1.2, cex.main = 1.3)
lines(nu_range, f2_right, col = "blue", lwd = 2)
lines(nu_range, f3_right, col = "purple", lwd = 2)
legend("topright", legend = c("Dietz (1993)", "Gubbins et al. (2008)", "Turner et al. (2013)"),
       col = c("black", "blue", "purple"), lwd = 2, bty = "n", cex = 1.1)
```

## Model Fitting